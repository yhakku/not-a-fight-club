(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(o){if(o.ep)return;o.ep=!0;const c=n(o);fetch(o.href,c)}})();const G=()=>{const t=document.querySelector("body"),e=document.querySelector(".header__nav"),n=document.querySelector(".logo"),r=location.hash.slice(1)||"login",o=()=>{e.classList.add("hidden"),n.classList.remove("hidden"),document.querySelector("body").classList.remove("overlay")},c=i=>{document.querySelectorAll("[data-route]").forEach(d=>{d.dataset.route!==i?d.classList.add("hidden"):d.classList.remove("hidden")})};switch(r){case"fight":c("fight"),e.classList.remove("hidden"),t.classList.add("fight-background");break;case"characters":c("characters"),n.classList.add("hidden"),e.classList.remove("hidden"),e.style.marginLeft="auto",t.classList.add("overlay");break;case"settings":c("settings"),n.classList.add("hidden"),e.classList.remove("hidden"),e.style.marginLeft="auto",t.classList.add("overlay");break;default:c("login"),t.classList.remove("fight-background"),o();break}window.addEventListener("hashchange",G)},u={user:{nickname:null,avatarId:0,characters:[{name:"Gojo Satoru",maxHealth:110,health:110,damage:25,img:"src/assets/images/fight/Gojo.webp",attackChoice:null,defenceChoice:[],stats:{win:0,lose:0}},{name:"Yuji Itadori",maxHealth:100,health:100,damage:20,img:"src/assets/images/fight/Itadori.webp",attackChoice:null,defenceChoice:[],stats:{win:0,lose:0}},{name:"Kento Nanami",maxHealth:100,health:100,damage:20,img:"src/assets/images/fight/Nanami.webp",attackChoice:null,defenceChoice:[],stats:{win:0,lose:0}}]},battle:null},z="data",v=t=>{localStorage.setItem(z,JSON.stringify(t))},q=()=>{const t=localStorage.getItem(z);return t?JSON.parse(t):u},O=(t,e)=>{const n=document.createElement("p");n.className="login__greeting h2",n.textContent=`Konnichiwa, ${e}!`,t.insertAdjacentElement("afterend",n)},B=(t,e)=>{t.classList.toggle("hidden",e)},F=(t,e)=>{t.forEach(n=>{n.classList.toggle("hidden",!e)})},K=(t,e,n)=>{t.classList.toggle("invalid",n),e.classList.toggle("invalid",n)},ce=t=>{const e=document.querySelector(".login__greeting");e.innerHTML=`Konnichiwa, ${t}!`},D=(t,e,n)=>{t.classList.toggle("overlay",n),e.classList.toggle("hidden",n)},oe=t=>{document.addEventListener("click",e=>{const n=document.querySelector(".overlay");n&&e.target===n&&t()})},P=()=>{const t=document.querySelector("body");document.querySelector(".overlay");const e=document.querySelector(".logo"),n=document.querySelector(".characters__button-close"),r=document.querySelectorAll(".characters__nickname"),o=document.querySelectorAll(".characters__result-w"),c=document.querySelectorAll(".characters__result-l"),i=document.querySelectorAll(".characters__selected"),d=document.querySelector('a[href="#settings"]');let g=q();if(g.user.nickname){r.forEach(p=>{p.innerHTML=g.user.nickname}),g=q(),g.user.characters.forEach((p,L)=>{o[L]&&(o[L].innerHTML=p.stats.win),c[L]&&(c[L].innerHTML=p.stats.lose)});const l=g.user.avatarId??0;i[l].checked=!0,i.forEach((p,L)=>{p.addEventListener("change",()=>{p.checked&&i.forEach((S,C)=>{C!==L&&(S.checked=!1)}),g.user.avatarId=L,v(g)})})}let h=null,y=location.hash;window.addEventListener("hashchange",()=>{h=y,y=location.hash,y==="#characters"?d.classList.add("disabled"):d.classList.remove("disabled")});const m=()=>{t.classList.remove("overlay"),e.classList.remove("hidden"),h&&h!==y?location.hash=h:location.hash="#login"};n&&n.addEventListener("click",m),oe(m)},R=()=>{const t=document.querySelector("body"),e=document.querySelector(".logo"),n=document.querySelector(".settings__button-close"),r=document.querySelector('a[href="#characters"]'),o=document.querySelector(".change-name__form"),c=document.querySelector(".change-name__input");document.querySelector(".login__title");const i=q();let d=i.user.nickname;i.user.nickname?(c.placeholder=d,console.log(c.placeholder)):location.hash="#login",o.addEventListener("submit",y=>{y.preventDefault(),d=c.value.trim(),u.user.nickname=d,v(u),P(),ce(d),D(t,e,!1),history.back()});let g=location.hash;window.addEventListener("hashchange",()=>{g=location.hash,g==="#settings"?r.classList.add("disabled"):r.classList.remove("disabled")});const h=()=>{D(t,e,!1),history.back()};n&&n.addEventListener("click",h)},re=()=>{const t=document.querySelector(".login__title"),e=document.querySelector(".form"),n=document.querySelector(".form__form-container"),r=document.querySelector(".form__input"),o=document.querySelector(".form__error"),c=document.querySelector(".login__button-fight"),i=document.querySelector(".login__button-chars"),d=document.querySelector(".login__button-settings");let h=q().user.nickname;h===null?(n.style.paddingBottom="10px",r.focus(),F([c,i,d],!1)):(B(e,!0),O(t,h)),e.addEventListener("submit",y=>{if(y.preventDefault(),h=r.value.trim(),h)B(e,!0),O(t,h),F([c,i,d],!0);else return;u.user.nickname=h,v(u),P(),R()}),r.addEventListener("input",()=>{const y=r.validity;r.setCustomValidity(" "),y.patternMismatch?K(r,o,!0):(K(r,o,!1),r.setCustomValidity(""))})},le=()=>{const t=document.querySelector(".login__button-fight"),e=document.querySelector(".fight__fight-button"),n=document.querySelectorAll(".attack-panel .fight__button"),r=document.querySelectorAll(".defence-panel .fight__button"),o=document.querySelector('a[href="#characters"]'),c=document.querySelector('a[href="#settings"]'),i=["Head","Neck","Body","Belly","Legs"],d=[{name:"Kenjaku",maxHealth:100,health:100,damage:20,attackZone:1,defenceZone:2,img:"src/assets/images/fight/Ken.webp"},{name:"Sukuna",maxHealth:110,health:110,damage:25,attackZone:2,defenceZone:2,img:"src/assets/images/fight/Sukuna.webp"},{name:"Fushiguro Toji",maxHealth:100,health:100,damage:20,attackZone:1,defenceZone:3,img:"src/assets/images/fight/Todzi.webp"}],g=()=>{const s=Math.floor(Math.random()*d.length);return d[s]},h=q();h.user.nickname&&(u.user.nickname=h.user.nickname);const y=()=>u.user.characters[h.user.avatarId];let m=g(),l=y();const p=()=>{const s=document.querySelector(".fight__card--antagonist");s.innerHTML=`
      <div class="fight__image-container">
        <img
          class="fight__image"
          src=${m.img}
          alt=${m.name}
          width="260"
          height="320"
          loading="lazy"
        >
      </div>
      <div class="fight__hp-control hp-control">
        <div class="hp-control__full">
          <span class="hp-control__hp-enemy"></span>
        </div>
          <span class="hp-control__amount">
            <span class="hp-control__count-enemy">${m.health}</span>
              /${m.maxHealth}
          </span>
        </div>`;const a=document.querySelector(".hp-control__hp-enemy");a.style.width=`${m.health}%`},L=()=>{n.forEach(s=>{s.addEventListener("click",()=>{n.forEach(a=>{a.classList.remove("selected"),s.classList.add("selected"),l.attackChoice=s.textContent,S()})}),r.forEach(a=>{a.addEventListener("click",()=>{const f=a.textContent;l.defenceChoice.includes(f)?(l.defenceChoice=l.defenceChoice.filter(_=>_!==f),a.classList.remove("selected")):l.defenceChoice.length<2&&(l.defenceChoice.push(f),a.classList.add("selected")),S()})})})},S=()=>{l.attackChoice&&l.defenceChoice.length===2?e.classList.remove("disabled"):e.classList.add("disabled")};L(),S();const C=()=>{const s=document.querySelector(".fight__card--protagonist");s.innerHTML=`
      <div class="fight__image-container">
        <img
          class="fight__image"
          src=${l.img}
          alt=${l.name}
          width="260"
          height="320"
          loading="lazy"
        >
      </div>
      <div class="fight__hp-control hp-control">
        <div class="hp-control__full">
          <span class="hp-control__hp-player"></span>
        </div>
          <span class="hp-control__amount">
            <span class="hp-control__count-player">${l.health}</span>
              /${l.maxHealth}
          </span>
        </div>`;const a=document.querySelector(".hp-control__hp-player");a.style.width=`${l.health}%`},A=()=>{u.battle={player:{...l},enemy:{...m},log:[]},p(),C()},T=()=>Math.floor(Math.random()*100)<20,V=()=>{const{player:s,enemy:a,log:f}=u.battle,{enemyAttackZone:_,enemyDefenceZone:Y}=J(),U=document.querySelector(".hp-control__hp-player"),Q=document.querySelector(".hp-control__hp-enemy"),x=document.querySelector(".logs__list"),W=document.querySelector(".hp-control__count-player"),X=document.querySelector(".hp-control__count-enemy"),Z=T(),I=T(),N=1.5;let k=s.damage,b=a.damage,H=Y.join(" ").includes(l.attackChoice),$=l.defenceChoice.join(" ").includes(_.join(""));H&&(k=0),$&&(b=0),Z?k*=N:H&&(k=0),I?b*=N:$&&(b=0),H&&!Z&&(k=0),$&&!I&&(b=0),a.health-=k,s.health-=b;const ee=()=>(s.health<0&&(s.health=0),s.health),te=()=>(a.health<0&&(a.health=0),a.health);U.style.width=`${ee()}%`,Q.style.width=`${te()}%`,W.innerHTML=`${s.health}`,X.innerHTML=`${a.health}`;const j=(M,E,ne,se,ie)=>{ne.forEach(ae=>{f.unshift(`<span class="logs__accent">${M.name}</span> attacks
         <span class="logs__accent">${E.name}</span>, dealing
         <span class="logs__accent">${se}</span> damage by hitting ${ae}`)})};j(s,a,[l.attackChoice],k),j(a,s,_,b),s.health<=0&&a.health<=0?(f.unshift('<span class="logs__accent">Draw!</span>'),s.stats.win+=1,s.stats.lose+=1,v(u),w()):s.health<=0?(f.unshift(`<span class="logs__accent">${a.name}</span> wins!`),s.stats.lose+=1,v(u),w()):a.health<=0&&(f.unshift(`<span class="logs__accent">${s.name}</span> wins!`),s.stats.win+=1,v(u),w()),x.innerHTML="",f.forEach(M=>{const E=document.createElement("li");E.classList.add("logs__item"),E.innerHTML=M,x.appendChild(E)}),v(u)},J=()=>{const a=[...i].sort(()=>.5-Math.random()).slice(0,m.attackZone),_=[...i].sort(()=>.5-Math.random()).slice(0,m.defenceZone);return{enemyAttackZone:a,enemyDefenceZone:_}},w=()=>{const s=document.querySelector(".attack-panel");e.style.display="none";const a=document.createElement("button");a.classList.add("fight__reset-button"),s.insertAdjacentElement("afterend",a),a.addEventListener("click",()=>{const f=u.user.avatarId;l={...u.user.characters[f],attackChoice:null,defenceChoice:[],health:u.user.characters[f].maxHealth},m={...m,health:m.maxHealth},u.battle={player:{...l},enemy:{...m},log:[]},p(),C(),a.style.display="none",e.style.display="flex",n.forEach(_=>_.classList.remove("selected")),r.forEach(_=>_.classList.remove("selected")),S()})};o.classList.add("disabled"),c.classList.add("disabled"),e.addEventListener("click",V),t.addEventListener("click",A),window.addEventListener("load",A)};G();re();P();R();le();
