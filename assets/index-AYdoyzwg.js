(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}})();const y=()=>{const t=document.querySelector(".header__nav"),s=document.querySelector(".logo"),n=location.hash.slice(1)||"login",c=()=>{t.classList.add("hidden"),s.classList.remove("hidden"),document.querySelector("body").classList.remove("overlay")},e=o=>{document.querySelectorAll("[data-route]").forEach(r=>{r.dataset.route!==o?r.classList.add("hidden"):r.classList.remove("hidden")})};switch(n){case"fight":e("fight"),t.classList.remove("hidden");break;case"characters":e("characters"),s.classList.add("hidden"),t.classList.remove("hidden"),t.style.marginLeft="auto",document.querySelector("body").classList.add("overlay");break;case"settings":e("settings"),s.classList.add("hidden"),t.classList.remove("hidden"),t.style.marginLeft="auto",document.querySelector("body").classList.add("overlay");break;default:e("login"),c();break}window.addEventListener("hashchange",y)},d={user:{nickname:null,avatarId:0,characters:[{id:1,stats:{win:0,lose:0}},{id:2,stats:{win:0,lose:0}},{id:3,stats:{win:0,lose:0}}]}},L="data",v=t=>{localStorage.setItem(L,JSON.stringify(t))},S=()=>{const t=localStorage.getItem(L);return t?JSON.parse(t):d},m=(t,s)=>{const n=document.createElement("p");n.className="login__greeting h2",n.textContent=`Konnichiwa, ${s}!`,t.insertAdjacentElement("afterend",n)},f=(t,s)=>{t.classList.toggle("hidden",s)},h=(t,s)=>{t.forEach(n=>{n.classList.toggle("hidden",!s)})},g=(t,s,n)=>{t.classList.toggle("invalid",n),s.classList.toggle("invalid",n)},_=()=>{const t=document.querySelectorAll(".characters__nickname"),s=document.querySelectorAll(".characters__result-w"),n=document.querySelectorAll(".characters__result-l"),c=document.querySelectorAll(".characters__selected"),e=S();if(e.user.nickname){t.forEach(r=>{r.innerHTML=e.user.nickname}),e.user.characters.forEach((r,a)=>{s[a]&&(s[a].innerHTML=r.stats.win),n[a]&&(n[a].innerHTML=r.stats.lose)});const o=e.user.avatarId??0;c[o].checked=!0,c.forEach((r,a)=>{r.addEventListener("change",()=>{r.checked&&c.forEach((u,i)=>{i!==a&&(u.checked=!1)}),e.user.avatarId=a})})}else location.hash="login"},p=()=>{const t=document.querySelector(".login__title"),s=document.querySelector(".form"),n=document.querySelector(".form__form-container"),c=document.querySelector(".form__input"),e=document.querySelector(".form__error"),o=document.querySelector(".login__button-fight"),r=document.querySelector(".login__button-chars"),a=document.querySelector(".login__button-settings");let i=S().user.nickname;i===null?(n.style.paddingBottom="10px",c.focus(),h([o,r,a],!1)):(f(s,!0),m(t,i)),s.addEventListener("submit",l=>{if(l.preventDefault(),i=c.value.trim(),i)f(s,!0),m(t,i),h([o,r,a],!0);else return;d.user.nickname=i,v(d),_()}),c.addEventListener("input",()=>{const l=c.validity;c.setCustomValidity(" "),l.patternMismatch?g(c,e,!0):(g(c,e,!1),c.setCustomValidity(""))})};y();p();_();
